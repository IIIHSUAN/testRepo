set_comparetable = function () {};

//The magic code to add show/hide custom event triggers
(function ($) {
    $.each(['show', 'hide', 'fadeIn', 'fadeOut'], function (i, ev) {
        var el = $.fn[ev];
        $.fn[ev] = function () {
            this.trigger(ev);
            return el.apply(this, arguments);
        };
    });
})(jQuery);

$(function () {
    // Tab 修正
    (function () {
        var tabnum = getUrlVars('tab');
        if (tabnum != null) {
            setTimeout(function () {
                $('.tab' + tabnum).removeClass('hide');
            }, 800);
        } else {
            // 當所有Tab都有設定連結的時候，第一頁不顯示Content
            var hideFlag = true;
            $('.tabmenu a').each(function (index) {
                var $this = $(this);
                if ($this[0].href == undefined || $this[0].href == '') {
                    hideFlag = false;
                    // 前面的頁數為連結且自身沒有連結的時候，必須展開Content
                    setTimeout(function () {
                        if ($this[0].className == 'selected') {
                            $('.tab' + (index + 1)).removeClass('hide');
                        }
                    }, 800);
                }
            });
            if (hideFlag) {
                $('.tab1').addClass('hide');
            }
        }

        $('.tabmenu a').click(function () {
            var $this = $(this);
            var num = parseInt($(this).index()) + 1;
            if ($this.attr('href') == undefined || $this.attr('href') == '') {
                $('.tab' + num).removeClass('hide');
            } else {
                $('.tab' + num).addClass('hide');
            }
        });
    })();

    // 遮罩修正
    (function () {
        $('.overlay').on('show', function () {
            $('.overlay').off('mousedown');
        });
        $('.overlay').on('hide', function () {
            $('.overlay').off('mousedown');
        });
        $('.overlay').on('fadeIn', function () {
            $('.overlay').off('mousedown');
        });
        $('.overlay').on('fadeOut', function () {
            $('.overlay').off('mousedown');
        });
    })();

    // 信用卡號輸入框修正
    (function () {
        $('.formobj-creditcard-last4').find('input').keyup(function (e) {
            if (String($(this).val()).length == 4) {
                $(this).parent().next().next().find('input').focus();
            }
        });
    })();
});